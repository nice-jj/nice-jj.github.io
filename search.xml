<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[Windows路由表设置]]></title>
      <url>http://www.nice-jj.com/2017/02/23/Windows%E8%B7%AF%E7%94%B1%E8%A1%A8%E8%AE%BE%E7%BD%AE/</url>
      <content type="html"><![CDATA[<p>因工作需要，在访问公司内部资源的时候必须要拨VPN才能连上公司总部的资源，如果拨了之后有可能会影响外网资源的访问速度。其实最重要的是，<br>拨了VPN，谁知道公司会不会对我的流量进行审计，最后“资源”都可能泄漏，所以就花了两个小时研究了一下怎么在拨了VPN之后，<br>只有在访问公司内部资源的时候才通过VPN访问，访问91p这些站点不走VPN。</p>
<h2 id="一、第一种方法是更改windows的路由表"><a href="#一、第一种方法是更改windows的路由表" class="headerlink" title="一、第一种方法是更改windows的路由表"></a>一、第一种方法是更改windows的路由表</h2><h3 id="1-查看没有拨VPN时候的路由表，并记录下来，命令是route-print，可以看到相应的路由表和网卡对应的接口列表（不懂路由的自己google相关资料）"><a href="#1-查看没有拨VPN时候的路由表，并记录下来，命令是route-print，可以看到相应的路由表和网卡对应的接口列表（不懂路由的自己google相关资料）" class="headerlink" title="1. 查看没有拨VPN时候的路由表，并记录下来，命令是route print，可以看到相应的路由表和网卡对应的接口列表（不懂路由的自己google相关资料）"></a>1. 查看没有拨VPN时候的路由表，并记录下来，命令是route print，可以看到相应的路由表和网卡对应的接口列表（不懂路由的自己google相关资料）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">IPv4 路由表</div><div class="line">===========================================================================</div><div class="line">活动路由:</div><div class="line">网络目标                   网络掩码          网关               接口      跃点数</div><div class="line">          0.0.0.0          0.0.0.0      192.168.0.1    192.168.0.105     20</div><div class="line">        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">      169.254.0.0      255.255.0.0            在链路上   169.254.162.228    276</div><div class="line">      169.254.0.0      255.255.0.0            在链路上     169.254.85.24    276</div><div class="line">    169.254.85.24  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  169.254.162.228  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">      192.168.0.0    255.255.255.0            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.105  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     192.168.0.105    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     169.254.85.24    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上   169.254.162.228    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">===========================================================================</div></pre></td></tr></table></figure>
<blockquote>
<p>关键看第一行，网络目标为0.0.0.0，掩码为0.0.0.0，网关为192.168.0.1，接口为192.168.0.105。<br>打个比方：从你的电脑访问百度的时候就好比从深圳到广州，网络目标是广州，网络掩码是广东省，网关是收费站，接口是深圳</p>
</blockquote>
<h3 id="2-拨了VPN之后的路由表，并记录下来"><a href="#2-拨了VPN之后的路由表，并记录下来" class="headerlink" title="2. 拨了VPN之后的路由表，并记录下来"></a>2. 拨了VPN之后的路由表，并记录下来</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">IPv4 路由表</div><div class="line">===========================================================================</div><div class="line">活动路由:</div><div class="line">网络目标                  网络掩码          网关           接口          跃点数</div><div class="line">          0.0.0.0          0.0.0.0      192.168.0.1    192.168.0.105     20</div><div class="line">          0.0.0.0          0.0.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">          0.0.0.0        128.0.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">        手动打码        255.255.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">       10.10.0.16  255.255.255.252            在链路上        10.10.0.18    286</div><div class="line">       10.10.0.18  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">       10.10.0.19  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">        手动打码          255.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">        手动打码          128.0.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">      169.254.0.0      255.255.0.0            在链路上   169.254.162.228    276</div><div class="line">      169.254.0.0      255.255.0.0            在链路上     169.254.85.24    276</div><div class="line">    169.254.85.24  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  169.254.162.228  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">      192.168.0.0    255.255.255.0            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.105  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">      手动打码        255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    手动打码          255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    手动打码          255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    手动打码          255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">  手动打码          255.255.255.255      192.168.0.1    192.168.0.105     20</div><div class="line">        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     192.168.0.105    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上        10.10.0.18    286</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     169.254.85.24    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上   169.254.162.228    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">===========================================================================</div></pre></td></tr></table></figure>
<blockquote>
<p>主要看前三行的路由信息，可以看到拨了VPN后通过10.10.0.17这个网关出去了，接下来就要删除这些路由信息</p>
</blockquote>
<h3 id="3-删除网络目标为0-0-0-0的路由规则，其余不需要删除，再查看路由信息"><a href="#3-删除网络目标为0-0-0-0的路由规则，其余不需要删除，再查看路由信息" class="headerlink" title="3. 删除网络目标为0.0.0.0的路由规则，其余不需要删除，再查看路由信息"></a>3. 删除网络目标为0.0.0.0的路由规则，其余不需要删除，再查看路由信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">C:\Users\Administrator&gt;route delete 0.0.0.0</div><div class="line"> 操作完成!</div><div class="line"></div><div class="line">C:\Users\Administrator&gt;route print</div><div class="line">IPv4 路由表</div><div class="line">===========================================================================</div><div class="line">活动路由:</div><div class="line">网络目标                   网络掩码          网关               接口      跃点数</div><div class="line">        手动打码        255.255.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">       10.10.0.16  255.255.255.252            在链路上        10.10.0.18    286</div><div class="line">       10.10.0.18  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">       10.10.0.19  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">        手动打码          255.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">        手动打码          128.0.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">      169.254.0.0      255.255.0.0            在链路上   169.254.162.228    276</div><div class="line">      169.254.0.0      255.255.0.0            在链路上     169.254.85.24    276</div><div class="line">    169.254.85.24  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  169.254.162.228  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">      192.168.0.0    255.255.255.0            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.105  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">      手动打码        255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    手动打码          255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    手动打码          255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    手动打码          255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">  手动打码          255.255.255.255      192.168.0.1    192.168.0.105     20</div><div class="line">        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     192.168.0.105    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上        10.10.0.18    286</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     169.254.85.24    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上   169.254.162.228    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">===========================================================================</div></pre></td></tr></table></figure>
<h3 id="4-添加路由，表示访问任何信息都通过192-168-0-1网关"><a href="#4-添加路由，表示访问任何信息都通过192-168-0-1网关" class="headerlink" title="4. 添加路由，表示访问任何信息都通过192.168.0.1网关"></a>4. 添加路由，表示访问任何信息都通过192.168.0.1网关</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\Administrator&gt;route add 0.0.0.0 mask 0.0.0.0 192.168.0.1</div><div class="line"> 操作完成!</div></pre></td></tr></table></figure>
<h3 id="5-再查看路由表-可以看到访问所有地址（0-0-0-0）都通过192-168-0-1网关，访问公司内网资源都通过10-10-0-17网关，如果还有访问不到的，按照上面的命令添加即可"><a href="#5-再查看路由表-可以看到访问所有地址（0-0-0-0）都通过192-168-0-1网关，访问公司内网资源都通过10-10-0-17网关，如果还有访问不到的，按照上面的命令添加即可" class="headerlink" title="5. 再查看路由表,可以看到访问所有地址（0.0.0.0）都通过192.168.0.1网关，访问公司内网资源都通过10.10.0.17网关，如果还有访问不到的，按照上面的命令添加即可"></a>5. 再查看路由表,可以看到访问所有地址（0.0.0.0）都通过192.168.0.1网关，访问公司内网资源都通过10.10.0.17网关，如果还有访问不到的，按照上面的命令添加即可</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">IPv4 路由表</div><div class="line">===========================================================================</div><div class="line">活动路由:</div><div class="line">网络目标        网络掩码          网关       接口   跃点数</div><div class="line">          0.0.0.0          0.0.0.0      192.168.0.1    192.168.0.105     21</div><div class="line">        10.10.0.0      255.255.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">       10.10.0.16  255.255.255.252            在链路上        10.10.0.18    286</div><div class="line">       10.10.0.18  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">       10.10.0.19  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">        128.0.0.0        128.0.0.0       10.10.0.17       10.10.0.18     30</div><div class="line">      169.254.0.0      255.255.0.0            在链路上   169.254.162.228    276</div><div class="line">      169.254.0.0      255.255.0.0            在链路上     169.254.85.24    276</div><div class="line">    169.254.85.24  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  169.254.162.228  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">  169.254.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">      192.168.0.0    255.255.255.0            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.105  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">    192.168.0.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">    192.168.100.0    255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    192.168.197.0    255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    192.168.198.0    255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">    192.168.199.0    255.255.255.0       10.10.0.17       10.10.0.18     30</div><div class="line">  211.103.231.218  255.255.255.255      192.168.0.1    192.168.0.105     20</div><div class="line">        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    306</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     192.168.0.105    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上        10.10.0.18    286</div><div class="line">        224.0.0.0        240.0.0.0            在链路上     169.254.85.24    276</div><div class="line">        224.0.0.0        240.0.0.0            在链路上   169.254.162.228    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    306</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     192.168.0.105    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上        10.10.0.18    286</div><div class="line">  255.255.255.255  255.255.255.255            在链路上     169.254.85.24    276</div><div class="line">  255.255.255.255  255.255.255.255            在链路上   169.254.162.228    276</div><div class="line">===========================================================================</div></pre></td></tr></table></figure>
<h3 id="6-路由跟踪测试，可以看到访问内部资源通过VPN访问，访问外部资源不通过VPN访问，并且公网IP也显示的是其所在地的IP"><a href="#6-路由跟踪测试，可以看到访问内部资源通过VPN访问，访问外部资源不通过VPN访问，并且公网IP也显示的是其所在地的IP" class="headerlink" title="6. 路由跟踪测试，可以看到访问内部资源通过VPN访问，访问外部资源不通过VPN访问，并且公网IP也显示的是其所在地的IP"></a>6. 路由跟踪测试，可以看到访问内部资源通过VPN访问，访问外部资源不通过VPN访问，并且公网IP也显示的是其所在地的IP</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">C:\Users\Administrator&gt;tracert 192.168.x.x</div><div class="line"></div><div class="line">通过最多 30 个跃点跟踪</div><div class="line">到 wiki.xxx.cn [192.168.x.x] 的路由:</div><div class="line"></div><div class="line">  1    37 ms    37 ms    37 ms  10.10.x.x</div><div class="line">  2    37 ms    37 ms    37 ms  wiki.xxx.cn [192.168.x.x]</div><div class="line"></div><div class="line">跟踪完成。</div><div class="line"></div><div class="line">C:\Users\Administrator&gt;tracert www.baidu.com</div><div class="line"></div><div class="line">通过最多 30 个跃点跟踪</div><div class="line">到 www.a.shifen.com [119.75.217.109] 的路由:</div><div class="line"></div><div class="line">  1    &lt;1 毫秒   &lt;1 毫秒   &lt;1 毫秒 192.168.0.1</div><div class="line">  2     3 ms     2 ms     2 ms  192.168.13.254</div><div class="line">  3     1 ms     1 ms     1 ms  192.168.5.1</div><div class="line">  4     *        *        *     请求超时。</div><div class="line">  5     1 ms     1 ms     1 ms  10.193.181.11</div><div class="line">  6     3 ms     4 ms     2 ms  113.105.70.222</div><div class="line">  7     2 ms     2 ms     2 ms  121.15.179.129</div><div class="line">  8     2 ms     2 ms     2 ms  121.15.179.82</div><div class="line">  9     *        *        2 ms  183.56.65.30</div><div class="line"> 10    38 ms    39 ms    39 ms  202.97.65.101</div><div class="line"> 11     *        *        *     请求超时。</div><div class="line"> 12    37 ms    37 ms    37 ms  220.181.17.50</div><div class="line"> 13     *        *        *     请求超时。</div><div class="line"> 14     *        *        *     请求超时。</div><div class="line"> 15    35 ms    35 ms    35 ms  119.75.217.109</div><div class="line"></div><div class="line">跟踪完成。</div></pre></td></tr></table></figure>
<h3 id="7-总结就两条命令"><a href="#7-总结就两条命令" class="headerlink" title="7. 总结就两条命令"></a>7. 总结就两条命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">route delete 0.0.0.0</div><div class="line">route add 0.0.0.0 mask 0.0.0.0 192.168.0.1</div></pre></td></tr></table></figure>
<h2 id="二、还有一种方法，暂未实践，理论上可行"><a href="#二、还有一种方法，暂未实践，理论上可行" class="headerlink" title="二、还有一种方法，暂未实践，理论上可行"></a>二、还有一种方法，暂未实践，理论上可行</h2><p>准备两个路由器，其中一个要可以拨VPN的，利用笔记本（我们都用笔记本）的双网卡机制，无线网卡连VPN的路由器，有线网卡连另外一个路由器，然后在通过设置windows的路由表就可以实现<br>所需功能，并且省略拨VPN的麻烦</p>
<blockquote>
<p>如有错误，欢迎来搞</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 计算机网络 </category>
            
            <category> Windows路由表设置 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 计算机网络 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Linux启动顺序]]></title>
      <url>http://www.nice-jj.com/2017/02/19/Linux%E5%90%AF%E5%8A%A8%E9%A1%BA%E5%BA%8F/</url>
      <content type="html"><![CDATA[<h2 id="一、系统启动初始化init阶段"><a href="#一、系统启动初始化init阶段" class="headerlink" title="一、系统启动初始化init阶段"></a>一、系统启动初始化init阶段</h2><h3 id="1-Grub加载内核之后，第一个运行的程序是-sbin-init"><a href="#1-Grub加载内核之后，第一个运行的程序是-sbin-init" class="headerlink" title="1. Grub加载内核之后，第一个运行的程序是 /sbin/init"></a>1. Grub加载内核之后，第一个运行的程序是 /sbin/init</h3><p>init是SysVinit的一个实体进程，是系统所有进程的顶级父进程，PID是1  </p>
<h3 id="2-sbin-init-读取-etc-inittab文件，确定运行级别"><a href="#2-sbin-init-读取-etc-inittab文件，确定运行级别" class="headerlink" title="2. /sbin/init 读取 /etc/inittab文件，确定运行级别"></a>2. /sbin/init 读取 /etc/inittab文件，确定运行级别</h3><p>etc/inittab文件的信息会包含以下信息给init程序  </p>
<ul>
<li>捕获组合键的定义  </li>
<li>定义电源 fail/restore 脚本  </li>
<li>启动 getty 和虚拟控制台  </li>
<li>系统需要进入的 runlevel  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">[root@centos ~]# cat /etc/inittab</div><div class="line"># inittab is only used by upstart for the default runlevel.</div><div class="line">#</div><div class="line"># ADDING OTHER CONFIGURATION HERE WILL HAVE NO EFFECT ON YOUR SYSTEM.</div><div class="line">#</div><div class="line"># System initialization is started by /etc/init/rcS.conf</div><div class="line">#</div><div class="line"># Individual runlevels are started by /etc/init/rc.conf</div><div class="line">#</div><div class="line"># Ctrl-Alt-Delete is handled by /etc/init/control-alt-delete.conf</div><div class="line">#</div><div class="line"># Terminal gettys are handled by /etc/init/tty.conf and /etc/init/serial.conf,</div><div class="line"># with configuration in /etc/sysconfig/init.</div><div class="line">#</div><div class="line"># For information on how to write upstart event handlers, or how</div><div class="line"># upstart works, see init(5), init(8), and initctl(8).</div><div class="line">#</div><div class="line"># Default runlevel. The runlevels used are:</div><div class="line">#   0 - halt (Do NOT set initdefault to this)</div><div class="line">#   1 - Single user mode</div><div class="line">#   2 - Multiuser, without NFS (The same as 3, if you do not have networking)</div><div class="line">#   3 - Full multiuser mode</div><div class="line">#   4 - unused</div><div class="line">#   5 - X11</div><div class="line">#   6 - reboot (Do NOT set initdefault to this)</div><div class="line">#</div><div class="line">id:3:initdefault:</div></pre></td></tr></table></figure>
<p>当前系统使用有网络支持的多用户模式，字符终端，没有图形界面<br>Linux的运行等级设定如下:  </p>
<blockquote>
<p>0：关机<br>1：单用户模式<br>2：无网络支持的多用户模式<br>3：有网络支持的多用户模式<br>4：保留，未使用<br>5：有网络支持有X-Window支持的多用户模式<br>6：重新引导系统，即重启  </p>
</blockquote>
<h3 id="3-sbin-init-执行-etc-rc-d-rc-sysinit脚本"><a href="#3-sbin-init-执行-etc-rc-d-rc-sysinit脚本" class="headerlink" title="3. /sbin/init 执行 /etc/rc.d/rc.sysinit脚本"></a>3. /sbin/init 执行 /etc/rc.d/rc.sysinit脚本</h3><p>sysinit的是系统启动的初始化脚本, 会做以下一些工作：  </p>
<ul>
<li>激活 udev 和 selinux  </li>
<li>设置定义在/etc/sysctl.conf 中的内核参数  </li>
<li>设置系统时钟  </li>
<li>加载 keymaps  </li>
<li>使用交换分区  </li>
<li>设置主机名(hostname)  </li>
<li>根分区检查和 remount  </li>
<li>激活 RAID 和 LVM 设备  </li>
<li>开启磁盘配额  </li>
<li>检查并挂载所有文件系统  </li>
<li>清除过期的 locks 和 PID 文件  </li>
</ul>
<h3 id="4-sbin-init-执行-etc-rc-d-rc脚本"><a href="#4-sbin-init-执行-etc-rc-d-rc脚本" class="headerlink" title="4. /sbin/init 执行 /etc/rc.d/rc脚本"></a>4. /sbin/init 执行 /etc/rc.d/rc脚本</h3><blockquote>
<p>/etc/rc脚本确定 /etc/inittab文件配置的运行级别ID(X)。</p>
</blockquote>
<p>每个 runlevel X 都有一个这样的目录，目录名为/etc/rc.d/rcX.d。在这些目录下存放着很多不同的脚本。<br>文件名以 S (start) 开头的脚本就是启动时应该运行的脚本，S 后面跟的数字定义了这些脚本的执行顺序<br>文件名以 K (kill) 开头的脚本表示启动的时候不执行的脚本。<br>在/etc/rc.d/rcX.d 目录下的脚本其实都是一些软链接文件，真实的脚本文件存放在/etc/init.d 目录下, 这个目录的文件通常被称为Linux服务启动脚本  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[root@centos rc3.d]# pwd</div><div class="line">/etc/rc3.d</div><div class="line">[root@centos rc3.d]# ls -al</div><div class="line">总用量 8</div><div class="line">drwxr-xr-x.  2 root root 4096 11月 29 13:12 .</div><div class="line">drwxr-xr-x. 10 root root 4096 1月  27 09:34 ..</div><div class="line">lrwxrwxrwx.  1 root root   19 11月 29 12:49 K10saslauthd -&gt; ../init.d/saslauthd</div><div class="line">lrwxrwxrwx.  1 root root   17 11月 16 2015 K30postfix -&gt; ../init.d/postfix</div><div class="line">lrwxrwxrwx.  1 root root   20 11月 16 2015 K50netconsole -&gt; ../init.d/netconsole</div><div class="line">lrwxrwxrwx.  1 root root   21 11月 16 2015 K87restorecond -&gt; ../init.d/restorecond</div><div class="line">lrwxrwxrwx.  1 root root   15 11月 16 2015 K89rdisc -&gt; ../init.d/rdisc</div><div class="line">lrwxrwxrwx.  1 root root   19 11月 16 2015 K92ip6tables -&gt; ../init.d/ip6tables</div><div class="line">lrwxrwxrwx.  1 root root   18 11月 29 12:34 K92iptables -&gt; ../init.d/iptables</div><div class="line">lrwxrwxrwx.  1 root root   22 11月 16 2015 S02lvm2-monitor -&gt; ../init.d/lvm2-monitor</div><div class="line">lrwxrwxrwx.  1 root root   17 11月 16 2015 S10network -&gt; ../init.d/network</div><div class="line">lrwxrwxrwx.  1 root root   16 11月 16 2015 S11auditd -&gt; ../init.d/auditd</div><div class="line">lrwxrwxrwx.  1 root root   17 11月 16 2015 S12rsyslog -&gt; ../init.d/rsyslog</div><div class="line">lrwxrwxrwx.  1 root root   26 11月 16 2015 S25blk-availability -&gt; ../init.d/blk-availability</div><div class="line">lrwxrwxrwx.  1 root root   15 11月 16 2015 S25netfs -&gt; ../init.d/netfs</div><div class="line">lrwxrwxrwx.  1 root root   19 11月 16 2015 S26udev-post -&gt; ../init.d/udev-post</div><div class="line">lrwxrwxrwx.  1 root root   14 11月 26 08:19 S55sshd -&gt; ../init.d/sshd</div><div class="line">lrwxrwxrwx.  1 root root   15 11月 16 2015 S90crond -&gt; ../init.d/crond</div><div class="line">lrwxrwxrwx.  1 root root   15 11月 29 13:12 S95jexec -&gt; ../init.d/jexec</div><div class="line">lrwxrwxrwx.  1 root root   11 11月 16 2015 S99local -&gt; ../rc.local</div></pre></td></tr></table></figure>
<blockquote>
<p>chkconfig 名字就是对/etc/init.d/目录下的服务脚本进行管理的工具，实际上就是对 /etc/rcX.d/下的软链接文件的增删改。  </p>
</blockquote>
<h3 id="5-sbin-init-执行-etc-rc-d-rc-local-脚本"><a href="#5-sbin-init-执行-etc-rc-d-rc-local-脚本" class="headerlink" title="5. /sbin/init 执行 /etc/rc.d/rc.local 脚本"></a>5. /sbin/init 执行 /etc/rc.d/rc.local 脚本</h3><p>rc.local 是 Linux 留给用户进行个性化设置的地方。比如放一些自定义的启动命令  </p>
<h3 id="6-启动登录终端-sbin-mingetty，等待登录"><a href="#6-启动登录终端-sbin-mingetty，等待登录" class="headerlink" title="6. 启动登录终端/sbin/mingetty，等待登录"></a>6. 启动登录终端/sbin/mingetty，等待登录</h3><p>mingetty 会启动 /bin/login进程，用来验证帐户密码，输入正确的账户密码之后,从/etc/passwd的账户配置里面启动响应的shell,例如下面root帐户使用了bash<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[root@centos ~]# cat /etc/passwd</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">bin:x:1:1:bin:/bin:/sbin/nologin</div><div class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</div><div class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</div><div class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</div><div class="line">sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div><div class="line">halt:x:7:0:halt:/sbin:/sbin/halt</div><div class="line">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</div></pre></td></tr></table></figure></p>
<h2 id="二、用户登录阶段"><a href="#二、用户登录阶段" class="headerlink" title="二、用户登录阶段"></a>二、用户登录阶段</h2><h3 id="7-用户登录后先执行-etc-profile"><a href="#7-用户登录后先执行-etc-profile" class="headerlink" title="7. 用户登录后先执行 /etc/profile"></a>7. 用户登录后先执行 /etc/profile</h3><blockquote>
<p>这个文件是所有用户登录系统后的设置环境信息,当用户第一次登录时,该文件被执行. 并从/etc/profile.d目录的配置文件中搜集shell的设置<br>紧接着profile文件里面去启动 /etc/profile.d 下的所有文件  </p>
</blockquote>
<h3 id="8-执行-bash-profile"><a href="#8-执行-bash-profile" class="headerlink" title="8. 执行 ~/.bash_profile"></a>8. 执行 ~/.bash_profile</h3><blockquote>
<p>这个文件是用户专属的bash shell初始化脚本<br>当用户登录时,该文件仅仅执行一次!默认情况下,他设置一些环境变量<br>~/.bash_profile会判断 ~/.bashrc文件是否存在并执行，~/.bashrc会判断/etc/bashrc文件是否存在并执行，最后设置PATH环境变量，结束。<br>所以~/.bashrc和/etc/bashrc都是层层嵌套执行的。  </p>
</blockquote>
<h3 id="9-执行-bashrc"><a href="#9-执行-bashrc" class="headerlink" title="9. 执行 ~/.bashrc"></a>9. 执行 ~/.bashrc</h3><blockquote>
<p>这个文件是用户专属的bash shell初始化脚本<br>当登录时以及每次打开新的shell时,该文件被执行<br>~/.bashrc 会判断 /etc/bashrc文件是否存在并执行  </p>
</blockquote>
<h3 id="10-执行-etc-bashrc"><a href="#10-执行-etc-bashrc" class="headerlink" title="10. 执行 /etc/bashrc"></a>10. 执行 /etc/bashrc</h3><blockquote>
<p>这个文件是bash环境的全局文件。几乎默认存在，每个登录的用户上去之后都要初始化一下bash的环境。<br>当bash shell被打开时,该文件被执行（即每次新开一个终端，都会执行bashrc）</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
            <category> Linux启动顺序 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 运维 </tag>
            
            <tag> Linux </tag>
            
        </tags>
        
    </entry>
    
  
  
    
    <entry>
      <title><![CDATA[关于]]></title>
      <url>http://www.nice-jj.com/about/index.html</url>
      <content type="html"><![CDATA[<p>路漫漫其修远兮<br>联系我：957675270</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[读书]]></title>
      <url>http://www.nice-jj.com/reading/index.html</url>
      <content type="html"></content>
    </entry>
    
  
</search>
